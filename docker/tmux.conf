# AI Docker CLI - Mobile-Optimized tmux Configuration
# This configuration is designed for use on mobile devices with Mosh
# See docs/REMOTE_ACCESS.md for usage instructions

# ============================================================
# Prefix Key Configuration
# ============================================================
# Change prefix from Ctrl+B to Ctrl+A (easier on mobile keyboards)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# ============================================================
# General Settings
# ============================================================
# Enable mouse support (essential for mobile touch screens)
set -g mouse on

# Start window numbering at 1 (easier to reach on mobile)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer (Mosh has no scrollback, tmux provides it)
set -g history-limit 50000

# Reduce escape time (faster key response)
set -sg escape-time 10

# Enable focus events for applications that support them
set -g focus-events on

# ============================================================
# Display Settings
# ============================================================
# Enable 256 color support
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Status bar position (bottom for mobile - less intrusive)
set -g status-position bottom

# Simplified status bar for small screens
set -g status-left-length 20
set -g status-right-length 40
set -g status-left "[#S] "
set -g status-right "%H:%M"

# Status bar colors
set -g status-style "bg=colour235,fg=colour136"
set -g window-status-current-style "bg=colour136,fg=colour235,bold"

# Pane border colors
set -g pane-border-style "fg=colour235"
set -g pane-active-border-style "fg=colour136"

# ============================================================
# Window and Pane Management
# ============================================================
# Split panes using | and - (easier to remember)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Navigate panes with arrow keys (no prefix needed with -n)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Navigate panes with vim keys (with prefix)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes (hold prefix and use arrow keys)
bind -r Left resize-pane -L 5
bind -r Right resize-pane -R 5
bind -r Up resize-pane -U 5
bind -r Down resize-pane -D 5

# Create new window with current path
bind c new-window -c "#{pane_current_path}"

# ============================================================
# Session Management
# ============================================================
# Easy session switching
bind S choose-session

# Quick session creation
bind N command-prompt -p "New session name:" "new-session -s '%%'"

# ============================================================
# Copy Mode (vim-style)
# ============================================================
# Use vim keybindings in copy mode
setw -g mode-keys vi

# Enter copy mode with prefix + [
# Start selection with v, copy with y
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# ============================================================
# Reload Configuration
# ============================================================
# Easy config reload
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ============================================================
# Mobile-Specific Conveniences
# ============================================================
# Quick detach (prefix + d is default, but adding q as well)
bind q detach-client

# Toggle synchronize panes (useful for running same command in multiple panes)
bind a setw synchronize-panes \; display "Sync #{?pane_synchronized,ON,OFF}"

# Clear screen and history
bind C-l send-keys 'C-l' \; clear-history

# ============================================================
# Activity Monitoring
# ============================================================
# Visual activity notification
setw -g monitor-activity on
set -g visual-activity off

# ============================================================
# Claude Code Specific
# ============================================================
# Larger scrollback for AI conversations
set -g history-limit 100000

# Note: UTF-8 is enabled by default in tmux 2.2+ and locale is configured
# via the environment (LANG=en_US.UTF-8) in the Dockerfile
